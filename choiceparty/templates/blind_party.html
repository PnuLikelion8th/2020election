{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/blind_party.css' %}">
</head>
<body> 
    <div class="party_container">
        
        <h1>나는..
         
        </h1>

        <section class="choice_container">
            
           
            {%if all_party.all|length == 1 %}

                끝!!!
                {%for i in all_party%}
                    {{i}}
                {%endfor%}
            {%else%}

            {%if msg != None %}

                <div onclick="hide_door()" class="party_choice_door">
                    어떤 정당이 부전승으로 올라갔습니다.
                </div>
            {% endif %}
                <div onclick="hide_door()" class="party_choice_door">
                    {% if len_party == 2%}
                    결승전 시작하기
                    {%else%}
                    {{len_party}}강 시작하기
                    {%endif%}
                </div>

            <form method = "POST">
                {%csrf_token%}
               
                <input type="hidden" name="unearned" value={{unearned}}>
                
                <article class="top">
                    {%for i in top %}
                    <input onchange="hide()" type="radio" name="party{{forloop.counter}}" value={{i}} id="party_t_{{forloop.counter}}">

                    <div class="card card{{forloop.counter}}">   
                        
                        <label for="party_t_{{forloop.counter}}"">
                            다음페이지로

                        </label>

                            {%if i.partypolicy_set.all|length > 0 %}
                                {% for j in i.partypolicy_set.all %}
                                    <div onclick="open_detail()" class="policy_item">
                                        {{j.title}}</div>
                                {%endfor%}
                            {%else%}
                                제출한 정당정책이 없습니다.
                            {%endif%}
                    </div>
                    {%endfor%}
                </article>


                <div class="divider_line"> 번호를 누르면 자세히 볼수있어요! </div>

                <article class="bottom">
                    {%for i in bottom %}
                        <input onchange="hide()" type="radio" name="party{{forloop.counter}}" value={{i}} id="party_b_{{forloop.counter}}">

                        <div class="card card{{forloop.counter}}">

                            <label for="party_b_{{forloop.counter}}" > 다음페이지로
                            </label>

                                {%if i.partypolicy_set.all|length > 0 %}
                                    {% for j in i.partypolicy_set.all %}
                                    <div class="policy_item">{{j.number}}<br>
                                        {{j.title}}</div>
                                    {%endfor%}
                                {%else%}
                                    제출한 정당정책이 없습니다.
                                {%endif%}
                            
                        </div>
                    {%endfor%}

                </article>





            </form>
            {%endif%}
        </section>
        <div>
            TOP:
            {%for i in top %}
                {{i}}
            
            {%endfor%}
        </div>
        <div>
            BOTTOM:
            {%for i in bottom %}
            {{i}}
        
            {%endfor%}
        </div>
    </div>
</body>
<script>
   
    function hide(){
        cho_list = document.querySelectorAll('.' + this.event.target.nextSibling.nextSibling.classList[1])
        
        //min width줄여서 애니메이션 효과 들어가도록 제작
        cho_list[0].classList.add('zero_width')
        cho_list[1].classList.add('zero_width')
        //클릭하면 해당 div 내 text제거되게함
        cho_list[0].innerHTML = ""
        cho_list[1].innerHTML = ""

        if  (this.event.target.name.substr(5) === document.querySelector('.top > div:last-child').classList[1].substr(4)){
            document.querySelector('.choice_container > form').submit()
        }

    }
    function hide_door(){
                this.event.target.classList.add('close_door')
                this.event.target.innerHTML = ""
    }
    function open_detail(){

    }
</script>
</html>